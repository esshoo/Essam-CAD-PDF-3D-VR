<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>CAD Viewer</title>

  <link rel="stylesheet" href="./global.css" />
  <link rel="stylesheet" href="./iconfont/iconfont.css" />
  <link rel="stylesheet" href="./iconfont/iconfont2.css" />
  <script src="./libs/pdf/pdf.min.js"></script>

  <style>
    html, body { width: 100%; height: 100%; margin: 0; overflow: hidden; background: #111; }
    #myCanvas { width: 100vw; height: 100vh; }
  </style>

  <!-- Import map: x-viewer + three -->
  <script type="importmap">
    {
      "imports": {
        "@x-viewer/core": "./libs/x-viewer/core/dist/index.esm.js",
        "@x-viewer/plugins": "./libs/x-viewer/plugins/dist/index.esm.js",
        "@x-viewer/ui": "./libs/x-viewer/ui/dist/index.esm.js",

        "three": "https://unpkg.com/three@0.160.0/build/three.module.js",
        "three/addons/": "https://unpkg.com/three@0.160.0/examples/jsm/"
      }
    }
  </script>
</head>

<body>
  <div id="myCanvas"></div>

  <script type="module">
    import { CADViewerApp } from "./addons/cad-toolkit/viewer/CADViewer_app.js";

    const app = new CADViewerApp("myCanvas", {
      // IMPORTANT: keep x-viewer toolbar + bottom bar ON
      minimalUI: false,
      // IMPORTANT: do NOT show x-viewer built-in layers window (we replace it with our panel)
      replaceToolbarLayers: true,
    });

    await app.init();
    window.cadApp = app;

    console.log("Ready. Use toolbar normally. Layers button opens our panel.");
  </script>

  <!-- Floating translucent menu (Open / Layers / 3D) -->
  <script type="module" src="./addons/cad-toolkit/ui/FloatingFabMenu.js"></script>

  <!-- Draggable/resizable Rules panel (hidden until opened) -->
  <script type="module" src="./addons/cad-toolkit/ui/LayerRulesPanel.js"></script>

  <!-- 3D bridge (no buttons; controlled by toolbar/fab) -->
  <script type="module" src="./addons/cad-toolkit/renderers/three/CAD3DBridge.js"></script>
</body>
</html>
